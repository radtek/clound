{"remainingRequest":"G:\\intellij work\\micro-ui\\node_modules\\babel-loader\\lib\\index.js!G:\\intellij work\\micro-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!G:\\intellij work\\micro-ui\\src\\permission.js","dependencies":[{"path":"G:\\intellij work\\micro-ui\\src\\permission.js","mtime":1551167423694},{"path":"G:\\intellij work\\micro-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"G:\\\\intellij work\\\\micro-ui\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.array.some\";\n\n/**\n * 全站权限配置\n *\n */\nimport router from './router/router';\nimport store from '@/store';\nimport { getStore } from '@/util/store';\nimport { validatenull } from '@/util/validate';\nimport NProgress from 'nprogress'; // progress bar\n\nimport 'nprogress/nprogress.css'; // progress bar style\n\nNProgress.configure({\n  showSpinner: false\n});\nvar lockPage = store.getters.website.lockPage; // 锁屏页\n\nrouter.beforeEach(function (to, from, next) {\n  // 缓冲设置\n  if (to.meta.keepAlive === true && store.state.tags.tagList.some(function (ele) {\n    return ele.value === to.fullPath;\n  })) {\n    to.meta.$keepAlive = true;\n  } else {\n    NProgress.start();\n\n    if (to.meta.keepAlive === true && validatenull(to.meta.$keepAlive)) {\n      to.meta.$keepAlive = true;\n    } else {\n      to.meta.$keepAlive = false;\n    }\n  }\n\n  var meta = to.meta || {};\n\n  if (store.getters.access_token) {\n    if (store.getters.isLock && to.path != lockPage) {\n      next({\n        path: lockPage\n      });\n    } else if (to.path === '/login') {\n      next({\n        path: '/'\n      });\n    } else {\n      if (store.getters.roles.length === 0) {\n        store.dispatch('GetUserInfo').then(function () {\n          next(_objectSpread({}, to, {\n            replace: true\n          }));\n        }).catch(function () {\n          store.dispatch('FedLogOut').then(function () {\n            next({\n              path: '/login'\n            });\n          });\n        });\n      } else {\n        var value = to.query.src || to.fullPath;\n        var label = to.query.name || to.name;\n\n        if (meta.isTab !== false && !validatenull(value) && !validatenull(label)) {\n          store.commit('ADD_TAG', {\n            label: label,\n            value: value,\n            params: to.params,\n            query: to.query,\n            group: router.$avueRouter.group || []\n          });\n        }\n\n        next();\n      }\n    }\n  } else {\n    if (meta.isAuth === false) {\n      next();\n    } else {\n      next('/login');\n    }\n  }\n});\nrouter.afterEach(function () {\n  NProgress.done();\n  var title = store.getters.tag.label;\n  router.$avueRouter.setTitle(title);\n});",{"version":3,"sources":["G:\\intellij work\\micro-ui\\src\\permission.js"],"names":["router","store","getStore","validatenull","NProgress","configure","showSpinner","lockPage","getters","website","beforeEach","to","from","next","meta","keepAlive","state","tags","tagList","some","ele","value","fullPath","$keepAlive","start","access_token","isLock","path","roles","length","dispatch","then","replace","catch","query","src","label","name","isTab","commit","params","group","$avueRouter","isAuth","afterEach","done","title","tag","setTitle"],"mappings":"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","sourcesContent":["/**\n * 全站权限配置\n *\n */\nimport router from './router/router'\nimport store from '@/store'\nimport {getStore} from '@/util/store'\nimport {validatenull} from '@/util/validate'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nNProgress.configure({showSpinner: false})\nconst lockPage = store.getters.website.lockPage // 锁屏页\nrouter.beforeEach((to, from, next) => {\n  // 缓冲设置\n  if (to.meta.keepAlive === true && store.state.tags.tagList.some(ele => {\n    return ele.value === to.fullPath\n  })) {\n    to.meta.$keepAlive = true\n  } else {\n    NProgress.start()\n    if (to.meta.keepAlive === true && validatenull(to.meta.$keepAlive)) {\n      to.meta.$keepAlive = true\n    } else {\n      to.meta.$keepAlive = false\n    }\n  }\n  const meta = to.meta || {}\n  if (store.getters.access_token) {\n    if (store.getters.isLock && to.path != lockPage) {\n      next({path: lockPage})\n    } else if (to.path === '/login') {\n      next({path: '/'})\n    } else {\n      if (store.getters.roles.length === 0) {\n        store.dispatch('GetUserInfo').then(() => {\n          next({...to, replace: true})\n        }).catch(() => {\n          store.dispatch('FedLogOut').then(() => {\n            next({path: '/login'})\n          })\n        })\n      } else {\n        const value = to.query.src || to.fullPath\n        const label = to.query.name || to.name\n        if (meta.isTab !== false && !validatenull(value) && !validatenull(label)) {\n          store.commit('ADD_TAG', {\n            label: label,\n            value: value,\n            params: to.params,\n            query: to.query,\n            group: router.$avueRouter.group || []\n          })\n        }\n        next()\n      }\n    }\n  } else {\n    if (meta.isAuth === false) {\n      next()\n    } else {\n      next('/login')\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  NProgress.done()\n  const title = store.getters.tag.label\n  router.$avueRouter.setTitle(title)\n})\n"]}]}