{"remainingRequest":"G:\\intellij work\\micro-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\intellij work\\micro-ui\\src\\views\\portal\\tyyh\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\intellij work\\micro-ui\\src\\views\\portal\\tyyh\\index.vue","mtime":1560252539292},{"path":"G:\\intellij work\\micro-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {fetchList,fetchTree,fetchUser} from \"@/api/portal/tyyh/tyyh\";\nimport {tableOption} from '@/const/crud/portal/tyyh/tyyh';\nimport {mapGetters} from \"vuex\";\n\nexport default {\n    name: \"table_user\",\n    data() {\n        return {\n            props: {\n                value:'id',\n                label: 'text',\n                children: 'children'\n            },\n            orgId:'',\n            treeData: [],\n            option: tableOption,\n            page: {\n                total: 0, // 总页数\n                currentPage: 1, // 当前页数\n                pageSize: 10, // 每页显示多少条,\n                isAsc: false//是否倒序\n            },\n            list: [],\n            fullscreenLoading: false,\n            listLoading: false,\n            form: {},\n        };\n    },\n    computed: {\n        ...mapGetters([\"permissions\"])\n    },\n\n    created() {\n\n    },\n    methods: {\n        handleNodeClick(data) {\n            this.orgId=data.id\n            this.page.page = 1;\n            this.listLoading = true;\n            fetchList(Object.assign({\n                current: this.page.currentPage,\n                size: this.page.pageSize,\n                id: data.id\n            }, )).then(response => {\n                this.list = response.data.data.records;\n                this.page.total = response.data.data.total\n                this.listLoading = false;\n            });\n        },\n        loadNode(node, resolve) {\n            // 一级节点处理\n            if (node.level === 0) {\n                this.requestTree(resolve);\n            }\n            // 其余节点处理\n            if (node.level >= 1) {\n                this.getIndex(node, resolve);\n            }\n        },\n\n            // 异步加载叶子节点数据函数\n            getIndex(node, resolve) {\n                console.log(node)\n                var param = {\n                   pid:node.data.id,\n                };\n                fetchTree(param).then(response => {\n                    let treeData = response.data.data;\n                    resolve(treeData);\n                }).catch(err => {\n                });\n            },\n            // 首次加载一级节点数据函数\n            requestTree(resolve) {\n                //要传的参数\n                let param = {\n                };\n                fetchTree(param).then(response => {\n                    let treeData = response.data.data;\n                    this.orgId=treeData[1].id\n                    resolve(treeData);\n                }).catch(err => {\n                });\n            },\n\n        getList(page, params) {\n            this.listLoading = true;\n            fetchList(Object.assign({\n                current: page.currentPage,\n                size: page.pageSize\n            }, params)).then(response => {\n                this.list = response.data.data.records;\n                this.page.total = response.data.data.total\n                this.listLoading = false;\n                this.fullscreenLoading = false;\n            });\n        },\n\n        handleRefresh() {\n            this.getList(this.page)\n        },\n\n        DownUser() {\n            this.$confirm('确定同步用户吗?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.fullscreenLoading = true;\n                fetchUser(this.orgId).then(() => {\n                    this.$message({\n                        showClose: true,\n                        message: '同步成功',\n                        type: 'success'\n                    })\n                    this.getList(this.page,this.orgId);\n                })\n            })\n        },\n    },\n};\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/portal/tyyh","sourcesContent":["\r\n\r\n<template>\r\n    <div class=\"user\">\r\n        <basic-container>\r\n            <el-row :span=\"24\">\r\n                <el-col :xs=\"24\"\r\n                        :sm=\"24\"\r\n                        :md=\"5\"\r\n                        class=\"user__tree\">\r\n                    <el-tree\r\n                            :props=\"props\"\r\n                            :load=\"loadNode\"\r\n                            lazy\r\n                            @node-click=\"handleNodeClick\">\r\n                    </el-tree>\r\n                </el-col>\r\n                <el-col :xs=\"24\"\r\n                        :sm=\"24\"\r\n                        :md=\"19\"\r\n                        class=\"user__main\">\r\n                    <avue-crud :option=\"option\"\r\n                               ref=\"crud\"\r\n                               v-model=\"form\"\r\n                               :page=\"page\"\r\n                               @on-load=\"getList\"\r\n                               :table-loading=\"listLoading\"\r\n                               @refresh-change=\"handleRefresh\"\r\n                               v-loading.fullscreen.lock=\"fullscreenLoading\"\r\n                               :data=\"list\">\r\n                        <template slot=\"menuLeft\">\r\n                            <el-button\r\n                                       @click=\"DownUser\"\r\n                                       size=\"small\"\r\n                                       type=\"primary\"\r\n                                       icon=\"el-icon-upload\">同步用户\r\n                            </el-button>\r\n                        </template>\r\n                    </avue-crud>\r\n                </el-col>\r\n            </el-row>\r\n        </basic-container>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    import {fetchList,fetchTree,fetchUser} from \"@/api/portal/tyyh/tyyh\";\r\n    import {tableOption} from '@/const/crud/portal/tyyh/tyyh';\r\n    import {mapGetters} from \"vuex\";\r\n\r\n    export default {\r\n        name: \"table_user\",\r\n        data() {\r\n            return {\r\n                props: {\r\n                    value:'id',\r\n                    label: 'text',\r\n                    children: 'children'\r\n                },\r\n                orgId:'',\r\n                treeData: [],\r\n                option: tableOption,\r\n                page: {\r\n                    total: 0, // 总页数\r\n                    currentPage: 1, // 当前页数\r\n                    pageSize: 10, // 每页显示多少条,\r\n                    isAsc: false//是否倒序\r\n                },\r\n                list: [],\r\n                fullscreenLoading: false,\r\n                listLoading: false,\r\n                form: {},\r\n            };\r\n        },\r\n        computed: {\r\n            ...mapGetters([\"permissions\"])\r\n        },\r\n\r\n        created() {\r\n\r\n        },\r\n        methods: {\r\n            handleNodeClick(data) {\r\n                this.orgId=data.id\r\n                this.page.page = 1;\r\n                this.listLoading = true;\r\n                fetchList(Object.assign({\r\n                    current: this.page.currentPage,\r\n                    size: this.page.pageSize,\r\n                    id: data.id\r\n                }, )).then(response => {\r\n                    this.list = response.data.data.records;\r\n                    this.page.total = response.data.data.total\r\n                    this.listLoading = false;\r\n                });\r\n            },\r\n            loadNode(node, resolve) {\r\n                // 一级节点处理\r\n                if (node.level === 0) {\r\n                    this.requestTree(resolve);\r\n                }\r\n                // 其余节点处理\r\n                if (node.level >= 1) {\r\n                    this.getIndex(node, resolve);\r\n                }\r\n            },\r\n\r\n                // 异步加载叶子节点数据函数\r\n                getIndex(node, resolve) {\r\n                    console.log(node)\r\n                    var param = {\r\n                       pid:node.data.id,\r\n                    };\r\n                    fetchTree(param).then(response => {\r\n                        let treeData = response.data.data;\r\n                        resolve(treeData);\r\n                    }).catch(err => {\r\n                    });\r\n                },\r\n                // 首次加载一级节点数据函数\r\n                requestTree(resolve) {\r\n                    //要传的参数\r\n                    let param = {\r\n                    };\r\n                    fetchTree(param).then(response => {\r\n                        let treeData = response.data.data;\r\n                        this.orgId=treeData[1].id\r\n                        resolve(treeData);\r\n                    }).catch(err => {\r\n                    });\r\n                },\r\n\r\n            getList(page, params) {\r\n                this.listLoading = true;\r\n                fetchList(Object.assign({\r\n                    current: page.currentPage,\r\n                    size: page.pageSize\r\n                }, params)).then(response => {\r\n                    this.list = response.data.data.records;\r\n                    this.page.total = response.data.data.total\r\n                    this.listLoading = false;\r\n                    this.fullscreenLoading = false;\r\n                });\r\n            },\r\n\r\n            handleRefresh() {\r\n                this.getList(this.page)\r\n            },\r\n\r\n            DownUser() {\r\n                this.$confirm('确定同步用户吗?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.fullscreenLoading = true;\r\n                    fetchUser(this.orgId).then(() => {\r\n                        this.$message({\r\n                            showClose: true,\r\n                            message: '同步成功',\r\n                            type: 'success'\r\n                        })\r\n                        this.getList(this.page,this.orgId);\r\n                    })\r\n                })\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style lang=\"scss\">\r\n    .user {\r\n        height: 100%;\r\n\r\n        &__tree {\r\n            padding-top: 3px;\r\n            padding-right: 20px;\r\n        }\r\n\r\n        &__main {\r\n            .el-card__body {\r\n                padding-top: 0;\r\n            }\r\n        }\r\n    }\r\n</style>\r\n\r\n"]}]}