{"remainingRequest":"G:\\intellij work\\micro-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\intellij work\\micro-ui\\src\\views\\portal\\archive\\ylcs\\csba\\jbxx.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\intellij work\\micro-ui\\src\\views\\portal\\archive\\ylcs\\csba\\jbxx.vue","mtime":1559648897235},{"path":"G:\\intellij work\\micro-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\intellij work\\micro-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n    getCsbaJbxx,\n    findRyListPage,\n    getRybaCount,\n    getRyDetail,\n    ShouCan,\n    IsGz,\n    getRyImg,\n    getJbxxImg,\n    getPmtImg\n} from \"@/api/portal/archive/ylcs/csba\";\nimport {formOption} from '@/const/crud/portal/archive/ylcs/ryba/index';\nimport {ylcsDict} from \"@/const/crud/portal/archive/ylcs/ylcsDict\";\nimport '@/styles/portal/archive/place-detail.scss'\n\nexport default {\n    name: 'jbxx',\n    props: [\"csbaForm\"],\n    data() {\n        return {\n            csbaId: '',\n            csbabh: '',\n            compId: '',\n            dict: ylcsDict,\n            jbxxForm: {},\n            tableLoading: false,\n            page: {\n                total: 0, // 总页数\n                currentPage: 1, // 当前页数\n                pageSize: 5 // 每页显示多少条\n            },\n            dialogTableVisible: false,\n            dialogTablePlaceVisible: false,\n            tableData: [],\n            rybaCount: {},\n            rybaFormView: false,\n            rybaFormOption: formOption,\n            rybaFromDetail: {},\n            rybaFormTitle: '',\n            wscshow: false,\n            yscshow: false,\n            csgzQuery: {\n                dwbh: '',\n                menuId: ''\n            },\n            imgQuery:{\n                csbaId:'',\n                fjLeixingid:'',\n            },\n            ryImgMap : new Map(),\n        }\n    },\n    created() {\n        this.csbaId = this.csbaForm.csbaId\n        this.csbabh = this.csbaForm.csbaBabh\n        this.compId = this.csbaForm.compId\n        this.csgzQuery.menuId = this.csbaForm.menuId;\n        this.csgzQuery.dwbh = this.csbaForm.csbaId;\n        this.getJbxxform();\n        this.getList(this.page);\n        this.getRybaCount();\n        this.getIsGz();\n    },\n    methods: {\n        getList(page, params) {\n            this.ryImgMap.clear()\n            this.tableData = []\n            this.tableLoading = true\n            findRyListPage(Object.assign({\n                current: page.currentPage,\n                size: page.pageSize,\n                compId: this.compId,\n                csbabh: this.csbabh,\n                rybaCyzt: '10'\n            }, params)).then(response => {\n                this.tableData = response.data.data.records\n                this.page.total = response.data.data.total\n                this.tableLoading = false\n            })\n        },\n        getJbxxform() {\n            getCsbaJbxx(this.csbaId).then(response => {\n                this.jbxxForm = response.data.data\n            });\n            this.imgQuery.csbaId = this.csbaId\n            this.imgQuery.fjLeixingid='csba_fj_3'\n            getJbxxImg(this.imgQuery,'jbxxImg')\n            getPmtImg(this.csbaId,'pmtImg')\n        },\n        getRybaCount() {\n            getRybaCount(this.compId, this.csbabh).then(response => {\n                this.rybaCount = response.data.data\n            })\n        },\n        getRybaFormDetail(id) {\n            getRyDetail(id).then(response => {\n                this.rybaFromDetail = response.data.data\n            })\n        },\n        openRyxqDialog(row) {\n            this.rybaFormView = true\n            this.rybaFormTitle = \"人员详情\"\n            this.getRybaFormDetail(row.rybaId)\n            getRyImg(row.rybaZp,'ryImgPerson')\n        },\n        moreClick() {\n            this.$emit(\"moreClick\", \"2\");\n        },\n        getIsGz() {\n            IsGz(this.csgzQuery).then(response => {\n                var is = response.data.data\n                if (is > 0) {\n                    this.yscshow = true\n                    this.wscshow = false\n                } else {\n                    this.wscshow = true\n                    this.yscshow = false\n                }\n            })\n        },\n        wsc() {\n            ShouCan(this.csgzQuery).then((res) => {\n                this.wscshow = false\n                this.yscshow = true\n            })\n        },\n        ysc() {\n            ShouCan(this.csgzQuery).then((res) => {\n                this.wscshow = true\n                this.yscshow = false\n            })\n        },\n        closeRyDialog(){\n            this.rybaFormView=false\n            this.ryImgMap.clear()\n        },\n        initRyImg(rybaZp,id) {\n            let ryImg=this.ryImgMap.get(rybaZp);\n            if(null===ryImg||'undefined'===typeof (ryImg)||''===ryImg) {\n                getRyImg(rybaZp,id)\n                this.ryImgMap.set(rybaZp,rybaZp);\n            }\n        },\n\n    },\n\n    watch: {\n        csbaForm: {\n            //深度监控父组件传递过来的值、否则无法根据传递过来的值更新数据\n            handler() {\n                this.csbaId = this.csbaForm.csbaId\n                this.csbabh = this.csbaForm.csbaBabh\n                this.compId = this.csbaForm.compId\n                this.csgzQuery.menuId = this.csbaForm.menuId;\n                this.csgzQuery.dwbh = this.csbaForm.csbaId;\n                this.getJbxxform();\n                this.getList(this.page);\n                this.getRybaCount();\n                this.getIsGz();\n            },\n            deep: true\n        },\n    }\n\n}\n",{"version":3,"sources":["jbxx.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"jbxx.vue","sourceRoot":"src/views/portal/archive/ylcs/csba","sourcesContent":["<template>\r\n    <div class=\"info-cate\">\r\n        <div class=\"fileInfo_main\">\r\n            <!--基础信息-->\r\n            <el-form class=\"form-main\">\r\n                <el-row class=\"form-main-title\">\r\n                    <span class=\"main-title-name\"> {{this.jbxxForm.csbaZcmc}}</span>\r\n                    <span class=\"main-title-score\">90分</span>\r\n                    <span class=\"main-title-level main-title-score\">A级</span>\r\n                    <a href=\"#\" v-if=\"wscshow\">\r\n                        <span class=\"main-title-wsc\" @click=\"wsc\"><i class=\"iconfontlogo alicon_shoucang\"></i>未收藏</span>\r\n                    </a>\r\n                    <a href=\"#\" v-if=\"yscshow\"><span class=\"main-title-ysc\" @click=\"ysc\"><i\r\n                            class=\"iconfontlogo alicon_shoucang\"></i>已收藏</span></a>\r\n                </el-row>\r\n                <el-row class=\"form-main-body\">\r\n                    <el-col :span=\"18\" class=\"form-body-l form-body-tabel\">\r\n                        <el-form label-width=\"135px\" label-position=\"left\">\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"法人代表\">\r\n                                        {{this.jbxxForm.csbaFddbr}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"证件号码\">\r\n                                        {{this.jbxxForm.csbaFddbrzj}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"开业日期\">\r\n                                        {{this.jbxxForm.csbaKyrq}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"备案进度\">\r\n                                        {{dict.getLabel(dict.csbaJindu,this.jbxxForm.csbaJindu)}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"经济类型\">\r\n                                        {{this.jbxxForm.csbaJjlx}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"区域编码\">\r\n                                        {{this.jbxxForm.compCode}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"营业执照\">\r\n                                        {{this.jbxxForm.csbaYyzz}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"备案节点\">\r\n                                        {{this.jbxxForm.notpass}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"备案状态\">\r\n                                        {{this.jbxxForm.state}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-tooltip placement=\"top\" effect=\"light\">\r\n                                        <div slot=\"content\">{{this.jbxxForm.csbaJymc}}</div>\r\n                                        <el-form-item label=\"实际经营名称\">\r\n                                            {{this.jbxxForm.csbaJymc}}\r\n                                        </el-form-item>\r\n                                    </el-tooltip>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-tooltip placement=\"top\" effect=\"light\">\r\n                                        <div slot=\"content\">{{this.jbxxForm.csbaYlnr}}</div>\r\n                                        <el-form-item label=\"娱乐项目内容\">\r\n                                            {{this.jbxxForm.csbaYlnr}}\r\n                                        </el-form-item>\r\n                                    </el-tooltip>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"签证签注种类\">\r\n                                        {{this.jbxxForm.csbaQzzl}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"上级主管部门\">\r\n                                        {{this.jbxxForm.csbaSjzgbm}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"备案通过时间\">\r\n                                        {{this.jbxxForm.csbaTongguoshijian}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"治安管理机构\">\r\n                                        {{this.jbxxForm.csbaZagljg}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col>\r\n                                    <el-col :span=\"8\">\r\n                                        <el-form-item label=\"股东信息\">\r\n                                            {{this.jbxxForm.csbaGdxx}}\r\n                                        </el-form-item>\r\n                                    </el-col>\r\n                                    <el-col :span=\"8\">\r\n                                        <el-form-item label=\"备案登记人\">\r\n                                            {{this.jbxxForm.csbaDjr}}\r\n                                        </el-form-item>\r\n                                    </el-col>\r\n                                    <el-col :span=\"8\">\r\n                                        <el-form-item label=\"登记人证件号\">\r\n                                            {{this.jbxxForm.csbaDjrzj}}\r\n                                        </el-form-item>\r\n                                    </el-col>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"版本\">\r\n                                        {{this.jbxxForm.version}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-tooltip placement=\"top\" effect=\"light\">\r\n                                        <div slot=\"content\">{{this.jbxxForm.csbaBz}}</div>\r\n                                        <el-form-item label=\"备注\">\r\n                                            {{this.jbxxForm.csbaBz}}\r\n                                        </el-form-item>\r\n                                    </el-tooltip>\r\n                                </el-col>\r\n                                <el-col :span=\"8\">\r\n                                    <el-form-item label=\"备案编号\">\r\n                                        {{this.jbxxForm.csbaBabh}}\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                            <el-col>\r\n                                <el-col :span=\"24\">\r\n                                    <el-form-item label=\"经营地址\">\r\n                                        {{this.jbxxForm.csbaJydz}}\r\n                                        <a href=\"#\"><i class=\"el-icon-location-outline\"></i></a>\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-col>\r\n                        </el-form>\r\n                    </el-col>\r\n                    <el-col :span=\"6\" class=\"form-body-r\">\r\n                        <img style=\"height: 100px;width: 100px\" id=\"jbxxImg\" />\r\n                    </el-col>\r\n                </el-row>\r\n            </el-form>\r\n            <!--卡片切换-->\r\n            <el-tabs type=\"border-card\" class=\"card-tab\">\r\n                <el-tab-pane label=\"异常警告\">\r\n                    <ul>\r\n                        <li>1</li>\r\n                        <li>[治安管理]</li>\r\n                        <li><a href=\"#\">从业人员一个月没有变动</a></li>\r\n                        <li>2019-05-15 11:18:00</li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>1</li>\r\n                        <li>[治安管理]</li>\r\n                        <li><a href=\"#\">从业人员一个月没有变动</a></li>\r\n                        <li>2019-05-15 11:18:00</li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>1</li>\r\n                        <li>[治安管理]</li>\r\n                        <li><a href=\"#\">从业人员一个月没有变动</a></li>\r\n                        <li>2019-05-15 11:18:00</li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>1</li>\r\n                        <li>[治安管理]</li>\r\n                        <li><a href=\"#\">从业人员一个月没有变动</a></li>\r\n                        <li>2019-05-15 11:18:00</li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>1</li>\r\n                        <li>[治安管理]</li>\r\n                        <li><a href=\" \">从业人员一个月没有变动</a></li>\r\n                        <li>2019-05-15 11:18:00</li>\r\n                    </ul>\r\n                </el-tab-pane>\r\n                <el-tab-pane label=\"规模设施\">\r\n                    <el-form>\r\n                        <el-col>\r\n                            <el-col :span=\"12\">\r\n                                <el-form-item label=\"经营面积\">\r\n                                    {{this.jbxxForm.csbaJymj}}\r\n                                </el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"12\">\r\n                                <el-form-item label=\"包厢数量\">\r\n                                    {{this.jbxxForm.csbaBxsl}}\r\n                                </el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"12\">\r\n                                <el-form-item label=\"场所经度\">\r\n                                    {{this.jbxxForm.csbaJd}}\r\n                                </el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"12\">\r\n                                <el-form-item label=\"场所纬度\">\r\n                                    {{this.jbxxForm.csbaWd}}\r\n                                </el-form-item>\r\n                            </el-col>\r\n                            <el-col :span=\"12\">\r\n                                <el-form-item label=\"核定消费者数量\">\r\n                                    {{this.jbxxForm.csbaHdxfzsl}}\r\n                                </el-form-item>\r\n                            </el-col>\r\n                        </el-col>\r\n                    </el-form>\r\n                </el-tab-pane>\r\n                <el-tab-pane label=\"平面图\">\r\n                    <img id=\"pmtImg\" style=\"height:165px; width:300px;\"/>\r\n                </el-tab-pane>\r\n            </el-tabs>\r\n            <!--在岗人数列表-->\r\n            <div class=\"table-box\">\r\n                <el-row class=\"table-box-top\">\r\n                    <el-col :span=\"4\" class=\"box-top-item1\">在职人数 <span>{{page.total}}</span></el-col>\r\n                    <el-col :span=\"4\" class=\"box-top-item2\">本月新上岗 <span>{{this.rybaCount.bysg}}人</span><i\r\n                            class=\"iconfontlogo aljiang1\"></i></el-col>\r\n                    <el-col :span=\"4\" class=\"box-top-item3\">本月离岗 <span>{{this.rybaCount.bylg}}人</span><i\r\n                            class=\"iconfontlogo aljiang\"></i></el-col>\r\n                    <el-col :span=\"12\" class=\"box-top-item4\">\r\n                        <el-button type=\"text\" @click=\"moreClick\">更多>></el-button>\r\n                    </el-col>\r\n                </el-row>\r\n                <el-table\r\n                        :header-cell-style=\"{background:'#eee',color:'#000'}\"\r\n                        :row-style=\"{height:'90px'}\"\r\n                        :data=\"tableData\"\r\n                        style=\"width: 100%\"\r\n                        :page=\"page\"\r\n                        :table-loading=\"tableLoading\">\r\n                    <el-table-column\r\n                            width=\"50\"\r\n                            type=\"index\"\r\n                            label=\"序号\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaZp\"\r\n                            label=\"照片\"\r\n                            align=\"center\"\r\n                            width=\"100\">\r\n                        <template slot-scope=\"scope\">\r\n                            <img style=\"height:80px; width:80px;border-radius: 5px;\" :id=\"scope.row.rybaId\"\r\n                                 src=\"/img/people.png\"\r\n                                 :src=\"initRyImg(scope.row.rybaZp,scope.row.rybaId)\"/>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaMc\"\r\n                            label=\"姓名\">\r\n                        <template slot-scope=\"scope\">\r\n                            <button type=\"button\" class=\"el-button el-button--text el-button--small\"\r\n                                    @click=\"openRyxqDialog(scope.row)\">{{scope.row.rybaMc}}\r\n                            </button>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaZjhm\"\r\n                            width=\"200\"\r\n                            label=\"证件号码\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaXb\"\r\n                            label=\"性别\">\r\n                        <template slot-scope=\"scope\">\r\n                            <span>{{ dict.getLabel(dict.sex,scope.row.rybaXb)}}</span>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaCsrq\"\r\n                            min-width=\"120\"\r\n                            label=\"出生日期\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaLb\"\r\n                            min-width=\"120\"\r\n                            label=\"类别\">\r\n                        <template slot-scope=\"scope\">\r\n                            <span>{{ dict.getLabel(dict.rylb,scope.row.rybaLb)}}</span>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaGwmc\"\r\n                            label=\"岗位名称\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaDjsj\"\r\n                            min-width=\"120\"\r\n                            label=\"上岗日期\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaLzsj\"\r\n                            min-width=\"120\"\r\n                            label=\"离岗日期\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaCyzt\"\r\n                            min-width=\"120\"\r\n                            label=\"状态\">\r\n                        <template slot-scope=\"scope\">\r\n                            <span>{{ dict.getLabel(dict.ryzt,scope.row.rybaCyzt)}}</span>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            width=\"200\"\r\n                            prop=\"rybaLb\"\r\n                            label=\"七类从业人员类别\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n            <!--人脸识别-->\r\n            <div class=\"table-face\">\r\n                <div class=\"table-face-top\">\r\n                    <el-row>\r\n                        <el-col :span=\"20\" class=\"face-top-title\">\r\n                            人脸识别\r\n                        </el-col>\r\n                        <el-col :span=\"4\" class=\"face-top-more\">\r\n                            <el-button type=\"text\" @click=\"dialogTablePlaceVisible = true\">更多>></el-button>\r\n                        </el-col>\r\n                    </el-row>\r\n                </div>\r\n                <el-table\r\n                        class=\"table-face-body\"\r\n                        :header-cell-style=\"{background:'#eee',color:'#000'}\"\r\n                        :data=\"tableData\"\r\n                        style=\"width: 100%\">\r\n                    <el-table-column\r\n                            width=\"50\"\r\n                            type=\"index\"\r\n                            label=\"序号\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaMc\"\r\n                            label=\"姓名\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaZjhm\"\r\n                            width=\"200\"\r\n                            label=\"证件号码\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaXb\"\r\n                            width=\"70\"\r\n                            label=\"姓别\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaCsrq\"\r\n                            min-width=\"120\"\r\n                            label=\"出生日期\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaLb\"\r\n                            label=\"人员类型\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"rybaDjsj\"\r\n                            min-width=\"120\"\r\n                            label=\"出现时间\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            width=\"200\"\r\n                            prop=\"rybaLb\"\r\n                            label=\"七类人员类型\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n            <!--地图区域-->\r\n            <div class=\"map table-face\">\r\n                <div class=\"table-face-top\">\r\n                    <el-row>\r\n                        <el-col :span=\"20\" class=\"face-top-title\">\r\n                            地图区域\r\n                        </el-col>\r\n                    </el-row>\r\n                </div>\r\n                <div class=\"map_box\">\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!--从业人员详情弹窗-->\r\n        <el-dialog :title=\"rybaFormTitle\" :visible.sync=\"rybaFormView\" :fullscreen=\"true\" :append-to-body=\"true\" @close='closeRyDialog'>\r\n            <avue-detail :option=\"rybaFormOption\" v-model=\"rybaFromDetail\">\r\n                <template slot=\"rybaZpContent\" slot-scope=\"scope\">\r\n                    <img style=\"height: 100px;width: 100px\"  id=\"ryImgPerson\"/>\r\n                </template>\r\n            </avue-detail>\r\n            <div slot=\"footer\"\r\n                 class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"closeRyDialog\">关 闭\r\n                </el-button>\r\n            </div>\r\n        </el-dialog>\r\n        <el-dialog title=\"人脸识别\"\r\n                   width=\"80%\"\r\n                   :visible.sync=\"dialogTablePlaceVisible\">\r\n            <el-table\r\n                    class=\"table-face-body\"\r\n                    :header-cell-style=\"{background:'#eee',color:'#000'}\"\r\n                    :data=\"tableData\"\r\n                    style=\"width: 100%\">\r\n                <el-table-column\r\n                        label=\"序号\"\r\n                        type=\"index\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaMc\"\r\n                        label=\"姓名\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaZjhm\"\r\n                        width=\"200\"\r\n                        label=\"证件号码\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaXb\"\r\n                        label=\"姓别\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaCsrq\"\r\n                        min-width=\"120\"\r\n                        label=\"出生日期\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaLb\"\r\n                        label=\"人员类型\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"rybaDjsj\"\r\n                        min-width=\"120\"\r\n                        label=\"出现时间\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        width=\"200\"\r\n                        prop=\"rybaLb\"\r\n                        label=\"七类人员类型\">\r\n                </el-table-column>\r\n            </el-table>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        getCsbaJbxx,\r\n        findRyListPage,\r\n        getRybaCount,\r\n        getRyDetail,\r\n        ShouCan,\r\n        IsGz,\r\n        getRyImg,\r\n        getJbxxImg,\r\n        getPmtImg\r\n    } from \"@/api/portal/archive/ylcs/csba\";\r\n    import {formOption} from '@/const/crud/portal/archive/ylcs/ryba/index';\r\n    import {ylcsDict} from \"@/const/crud/portal/archive/ylcs/ylcsDict\";\r\n    import '@/styles/portal/archive/place-detail.scss'\r\n\r\n    export default {\r\n        name: 'jbxx',\r\n        props: [\"csbaForm\"],\r\n        data() {\r\n            return {\r\n                csbaId: '',\r\n                csbabh: '',\r\n                compId: '',\r\n                dict: ylcsDict,\r\n                jbxxForm: {},\r\n                tableLoading: false,\r\n                page: {\r\n                    total: 0, // 总页数\r\n                    currentPage: 1, // 当前页数\r\n                    pageSize: 5 // 每页显示多少条\r\n                },\r\n                dialogTableVisible: false,\r\n                dialogTablePlaceVisible: false,\r\n                tableData: [],\r\n                rybaCount: {},\r\n                rybaFormView: false,\r\n                rybaFormOption: formOption,\r\n                rybaFromDetail: {},\r\n                rybaFormTitle: '',\r\n                wscshow: false,\r\n                yscshow: false,\r\n                csgzQuery: {\r\n                    dwbh: '',\r\n                    menuId: ''\r\n                },\r\n                imgQuery:{\r\n                    csbaId:'',\r\n                    fjLeixingid:'',\r\n                },\r\n                ryImgMap : new Map(),\r\n            }\r\n        },\r\n        created() {\r\n            this.csbaId = this.csbaForm.csbaId\r\n            this.csbabh = this.csbaForm.csbaBabh\r\n            this.compId = this.csbaForm.compId\r\n            this.csgzQuery.menuId = this.csbaForm.menuId;\r\n            this.csgzQuery.dwbh = this.csbaForm.csbaId;\r\n            this.getJbxxform();\r\n            this.getList(this.page);\r\n            this.getRybaCount();\r\n            this.getIsGz();\r\n        },\r\n        methods: {\r\n            getList(page, params) {\r\n                this.ryImgMap.clear()\r\n                this.tableData = []\r\n                this.tableLoading = true\r\n                findRyListPage(Object.assign({\r\n                    current: page.currentPage,\r\n                    size: page.pageSize,\r\n                    compId: this.compId,\r\n                    csbabh: this.csbabh,\r\n                    rybaCyzt: '10'\r\n                }, params)).then(response => {\r\n                    this.tableData = response.data.data.records\r\n                    this.page.total = response.data.data.total\r\n                    this.tableLoading = false\r\n                })\r\n            },\r\n            getJbxxform() {\r\n                getCsbaJbxx(this.csbaId).then(response => {\r\n                    this.jbxxForm = response.data.data\r\n                });\r\n                this.imgQuery.csbaId = this.csbaId\r\n                this.imgQuery.fjLeixingid='csba_fj_3'\r\n                getJbxxImg(this.imgQuery,'jbxxImg')\r\n                getPmtImg(this.csbaId,'pmtImg')\r\n            },\r\n            getRybaCount() {\r\n                getRybaCount(this.compId, this.csbabh).then(response => {\r\n                    this.rybaCount = response.data.data\r\n                })\r\n            },\r\n            getRybaFormDetail(id) {\r\n                getRyDetail(id).then(response => {\r\n                    this.rybaFromDetail = response.data.data\r\n                })\r\n            },\r\n            openRyxqDialog(row) {\r\n                this.rybaFormView = true\r\n                this.rybaFormTitle = \"人员详情\"\r\n                this.getRybaFormDetail(row.rybaId)\r\n                getRyImg(row.rybaZp,'ryImgPerson')\r\n            },\r\n            moreClick() {\r\n                this.$emit(\"moreClick\", \"2\");\r\n            },\r\n            getIsGz() {\r\n                IsGz(this.csgzQuery).then(response => {\r\n                    var is = response.data.data\r\n                    if (is > 0) {\r\n                        this.yscshow = true\r\n                        this.wscshow = false\r\n                    } else {\r\n                        this.wscshow = true\r\n                        this.yscshow = false\r\n                    }\r\n                })\r\n            },\r\n            wsc() {\r\n                ShouCan(this.csgzQuery).then((res) => {\r\n                    this.wscshow = false\r\n                    this.yscshow = true\r\n                })\r\n            },\r\n            ysc() {\r\n                ShouCan(this.csgzQuery).then((res) => {\r\n                    this.wscshow = true\r\n                    this.yscshow = false\r\n                })\r\n            },\r\n            closeRyDialog(){\r\n                this.rybaFormView=false\r\n                this.ryImgMap.clear()\r\n            },\r\n            initRyImg(rybaZp,id) {\r\n                let ryImg=this.ryImgMap.get(rybaZp);\r\n                if(null===ryImg||'undefined'===typeof (ryImg)||''===ryImg) {\r\n                    getRyImg(rybaZp,id)\r\n                    this.ryImgMap.set(rybaZp,rybaZp);\r\n                }\r\n            },\r\n\r\n        },\r\n\r\n        watch: {\r\n            csbaForm: {\r\n                //深度监控父组件传递过来的值、否则无法根据传递过来的值更新数据\r\n                handler() {\r\n                    this.csbaId = this.csbaForm.csbaId\r\n                    this.csbabh = this.csbaForm.csbaBabh\r\n                    this.compId = this.csbaForm.compId\r\n                    this.csgzQuery.menuId = this.csbaForm.menuId;\r\n                    this.csgzQuery.dwbh = this.csbaForm.csbaId;\r\n                    this.getJbxxform();\r\n                    this.getList(this.page);\r\n                    this.getRybaCount();\r\n                    this.getIsGz();\r\n                },\r\n                deep: true\r\n            },\r\n        }\r\n\r\n    }\r\n</script>"]}]}