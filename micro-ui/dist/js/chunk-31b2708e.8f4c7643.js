(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31b2708e"],{"59fb":function(e,t,r){"use strict";r.d(t,"d",function(){return n}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return a}),r.d(t,"e",function(){return o}),r.d(t,"c",function(){return l}),r.d(t,"f",function(){return d});var i=r("b5c6");function n(e){return Object(i["a"])({url:"/admin/dict/page",method:"get",params:e})}function s(e){return Object(i["a"])({url:"/admin/dict/",method:"post",data:e})}function a(e,t,r){return Object(i["a"])({url:"/admin/dict/"+e+"/"+t+"/"+r,method:"delete"})}function o(e){return Object(i["a"])({url:"/admin/dict/",method:"put",data:e})}function l(e){return Object(i["a"])({url:"/admin/dict/tree",method:"get",params:e})}function d(e){return Object(i["a"])({url:"/admin/dict/type/"+e,method:"get"})}},"91c0":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"execution"},[r("basic-container",[1==e.isTree?r("div",{staticClass:"filter-container"},[r("el-button-group",[e.permissions.sys_dict_edit?r("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleTreeAdd}},[e._v("添加\n        ")]):e._e(),e.permissions.sys_dict_edit?r("el-button",{attrs:{type:"primary",icon:"edit"},on:{click:e.handleTreeEdit}},[e._v("编辑\n        ")]):e._e(),e.permissions.sys_dict_del?r("el-button",{attrs:{type:"primary",icon:"delete"},on:{click:e.handleTreeDelete}},[e._v("删除\n        ")]):e._e()],1)],1):e._e(),1==e.isTree?r("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:8}},[r("el-tree",{staticClass:"filter-tree",attrs:{"node-key":"id","highlight-current":"",data:e.treeData,"default-expanded-keys":e.aExpandedKeys,"filter-node-method":e.filterNode,props:e.defaultProps},on:{"node-click":e.getNodeData,"node-expand":e.nodeExpand,"node-collapse":e.nodeCollapse}})],1):e._e(),1==e.isTree?r("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:16}},[r("el-card",{staticClass:"box-card"},[r("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"父级节点",prop:"parentId"}},[r("el-input",{attrs:{disabled:!0,placeholder:"请输入父级节点"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1),r("el-form-item",{attrs:{label:"数据值",prop:"value"}},[r("el-input",{attrs:{disabled:e.formEdit,placeholder:"请输入数据值"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),r("el-form-item",{attrs:{label:"标签名",prop:"label"}},[r("el-input",{attrs:{disabled:e.formEdit,placeholder:"请输入标签名"},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),r("el-form-item",{attrs:{label:"类型",prop:"type"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),r("el-form-item",{attrs:{label:"描述",prop:"description"}},[r("el-input",{attrs:{disabled:e.formEdit,placeholder:"请输入描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("el-form-item",{attrs:{label:"排序",prop:"sort"}},[r("el-input",{attrs:{type:"number",disabled:e.formEdit,placeholder:"请输入排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),r("el-form-item",{attrs:{label:"备注信息",prop:"remarks"}},[r("el-input",{attrs:{disabled:e.formEdit,placeholder:"请输入备注信息"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),r("el-form-item",{attrs:{label:"修改时间",prop:"updateTime"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.updateTime,callback:function(t){e.$set(e.form,"updateTime",t)},expression:"form.updateTime"}})],1),"update"==e.formStatus?r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveTree("form")}}},[e._v("更新\n            ")]),r("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1):e._e(),"create"==e.formStatus?r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveTree("form")}}},[e._v("保存\n            ")]),r("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1):e._e()],1)],1)],1):e._e(),0==e.isTree?r("avue-crud",{ref:"crud",attrs:{page:e.page,data:e.tableData,"table-loading":e.tableLoading,option:e.tableOption},on:{"on-load":e.getList,"row-update":e.handleUpdate,"row-save":e.handleSave,"search-change":e.searchChange,"row-del":e.rowDel,"selection-change":e.selectionChange},scopedSlots:e._u([{key:"menu",fn:function(t){return[e.permissions.sys_dict_edit?r("el-button",{attrs:{type:"text",icon:"el-icon-edit",size:"mini",plain:""},on:{click:function(r){return e.handleEdit(t.row,t.index)}}},[e._v("编辑\n        ")]):e._e(),e.permissions.sys_dict_del?r("el-button",{attrs:{type:"text",icon:"el-icon-delete",size:"mini",plain:""},on:{click:function(r){return e.handleDel(t.row,t.index)}}},[e._v("删除\n        ")]):e._e()]}}],null,!1,1009564906)},[r("template",{slot:"tip"},[e.permissions.sys_dict_del?r("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDelAll}},[e._v("删除\n        ")]):e._e()],1)],2):e._e()],1)],1)},n=[],s=r("5176"),a=r.n(s),o=(r("55dd"),r("e814")),l=r.n(o),d=(r("57e7"),r("cebc")),c=r("59fb"),u={selection:!0,border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",align:"center",refreshBtn:!1,showClomnuBtn:!1,searchSize:"mini",editBtn:!1,delBtn:!1,column:[{width:150,label:"数据值",prop:"value",rules:[{required:!0,message:"请输入数据值",trigger:"blur"}]},{label:"标签名",prop:"label",rules:[{required:!0,message:"请输入标签名",trigger:"blur"}]},{label:"类型",prop:"type",valueDefault:"",rules:[{required:!0,message:"请输入字典类型",trigger:"blur"}]},{label:"描述",prop:"description",rules:[{required:!0,message:"请输入字典描述",trigger:"blur"}]},{label:"排序",prop:"sort",type:"number",rules:[{required:!0,message:"请输入排序",trigger:"blur"}]},{label:"备注信息",prop:"remarks"}]},m=r("5880"),p={name:"dict",data:function(){return{tableData:[],page:{total:0,currentPage:1,pageSize:20},tableLoading:!1,tableOption:u,selData:[],isTree:0,aExpandedKeys:[],treeData:[],oExpandedKey:{},oTreeNodeChildren:{},defaultProps:{children:"children",label:"label"},labelPosition:"right",form:{id:void 0,parentId:void 0,parentIds:void 0,label:void 0,type:void 0,value:void 0,description:void 0,sort:void 0,remarks:void 0},rules:{value:[{required:!0,message:"数据值不能为空",trigger:"blur"}],label:[{required:!0,message:"标签名不能为空",trigger:"blur"}],description:[{required:!0,message:"描述不能为空",trigger:"blur"}],sort:[{required:!0,message:"排序不能为空",trigger:"blur"}]},formEdit:!0,formStatus:"",currentId:0,currentParentIds:0}},created:function(){this.form.type=this.$route.query.type,u.column[2].valueDefault=this.form.type,this.isTree=this.$route.query.isTree,1==this.isTree&&this.getTreeData()},mounted:function(){},computed:Object(d["a"])({},Object(m["mapGetters"])(["permissions"])),methods:{getTreeData:function(){var e=this;Object(c["c"])({type:this.form.type}).then(function(t){e.treeData=t.data.data})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},nodeExpand:function(e){var t=e.children;t.length>0&&(this.oExpandedKey[e.id]=!0,this.oTreeNodeChildren[e.id]=t),this.setExpandedKeys()},nodeCollapse:function(e){var t=this;this.oExpandedKey[e.id]=!1,this.treeRecursion(this.oTreeNodeChildren[e.id],function(e){t.oExpandedKey[e.id]=!1}),this.setExpandedKeys()},treeRecursion:function(e,t){if(e)for(var r=0;r<e.length;++r){var i=e[r];t&&t(i),this.treeRecursion(i.children,t)}},setExpandedKeys:function(){var e=this.oExpandedKey;for(var t in this.aExpandedKeys=[],e)e[t]&&this.aExpandedKeys.push(l()(t))},saveTree:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.form.id?Object(c["e"])(t.form).then(function(){t.$message({showClose:!0,message:"修改成功",type:"success"}),t.getTreeData()}):Object(c["a"])(t.form).then(function(e){t.$message({showClose:!0,message:"添加成功",type:"success"}),t.getTreeData(),t.resetForm(),t.formEdit=!0,t.formStatus=""}),console.log(t.form)})},handleTreeDelete:function(){var e=this;console.log(this.form.id),this.form.id?this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(c["b"])(e.form.id,e.form.type,e.isTree).then(function(){e.getTreeData(),e.resetForm(),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})}):this.$message({showClose:!0,message:"请选择要删除的节点",type:"warning"})},onCancel:function(){this.formEdit=!0,this.formStatus=""},resetForm:function(){this.form.id=void 0,this.form.parentId=this.currentId,this.form.label=void 0,this.form.value=void 0,this.form.description=void 0,this.form.sort=0,this.form.remarks=void 0,0==this.currentId?this.form.parentIds=this.currentId:this.form.parentIds=this.currentParentIds+","+this.currentId},getNodeData:function(e){this.form.id=e.id,this.form.label=e.label,this.form.parentId=e.parentId,this.form.parentIds=e.parentIds,this.form.value=e.value,this.form.description=e.description,this.form.sort=e.sort,this.form.remarks=e.remarks,this.currentId=e.id,this.currentParentIds=e.parentIds},handleTreeEdit:function(){this.form.id?(this.formEdit=!1,this.formStatus="update"):this.$message({showClose:!0,message:"请选择要修改的节点",type:"warning"})},handleTreeAdd:function(){this.resetForm(),this.formEdit=!1,this.formStatus="create"},getList:function(e,t){var r=this;this.tableLoading=!0,Object(c["d"])(a()({current:e.currentPage,size:e.pageSize,type:this.form.type},t)).then(function(e){r.tableData=e.data.data.records,r.page.total=e.data.data.total,r.tableLoading=!1})},handleAdd:function(){this.$refs.crud.rowAdd()},handleEdit:function(e,t){this.$refs.crud.rowEdit(e,t)},handleDel:function(e,t){this.$refs.crud.rowDel(e,t)},rowDel:function(e,t){var r=this,i=this;this.$confirm('是否确认删除标签名为"'+e.label+'",数据类型为"'+e.type+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(c["b"])(e.id,this.form.type,this.isTree)}).then(function(){r.getList(r.page),i.$message({showClose:!0,message:"删除成功",type:"success"})}).catch(function(){})},handleUpdate:function(e,t,r){var i=this;console.log(e),Object(c["e"])(e).then(function(){i.tableData.splice(t,1,a()({},e)),i.$message({showClose:!0,message:"修改成功",type:"success"}),i.getList(i.page),r()})},handleSave:function(e,t){var r=this;Object(c["a"])(e).then(function(i){r.tableData.push(a()({},e)),r.$message({showClose:!0,message:"添加成功",type:"success"}),r.getList(r.page),t()})},searchChange:function(e){this.getList(this.page,e)},handleDelAll:function(){var e=this;this.selData.length>0?this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t="",r=0;r<e.selData.length;r++)t+=e.selData[r].id+",";Object(c["b"])(t,e.form.type,e.isTree).then(function(){e.getList(e.page),e.$message({showClose:!0,message:"删除成功",type:"success"})})}):this.$message({showClose:!0,message:"请选择要删除的字典",type:"warning"})},selectionChange:function(e){this.selData=e}}},f=p,h=r("2877"),b=Object(h["a"])(f,i,n,!1,null,"46bd7690",null);t["default"]=b.exports}}]);